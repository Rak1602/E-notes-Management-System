{% extends "base.html" %}

{% block content %}
<div class="search-header">
    <form action="{{ url_for('search') }}" method="get">
      <input type="text" name="q" value="{{ query }}" placeholder="Search your notes...">
      <button type="submit">Search</button>
    </form>
    
    {% if query %}
    <div id="feedback-section" style="margin-top: 10px;">
      <span>Was this search helpful?</span>
      <button onclick="submitFeedback('👍')">👍</button>
      <button onclick="submitFeedback('👎')">👎</button>
    </div>
    {% endif %}
</div>

<div class="results">
    {% for note in notes %}
      <div class="note-card">
        <h3>{{ note.highlighted_title | safe }}</h3>
        <p>{{ note.highlighted_content | safe }}</p>
        <a href="{{ url_for('view_note', note_id=note.id) }}" class="view-note-btn">View Note</a>
      </div>
    {% else %}
      <p>No results found.</p>
    {% endfor %}
</div>


<script>
function submitFeedback(feedback) {
  fetch('/submit_feedback', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      query: "{{ query }}",
      feedback: feedback
    })
  })
  .then(response => response.json())
  .then(data => {
    if(data.status === 'success') {
      document.getElementById('feedback-section').innerHTML = '<p>Thank you for your feedback!</p>';
    }
  });
}
</script>

{% endblock %}
